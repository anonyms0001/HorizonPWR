<div class="my-8 px-4">
  <!-- Main 3 column grid -->
  <main class="pb-8">
    <div class="mx-auto px-4 sm:px-6 lg:px-8">
      <!-- Main 3 column grid -->
      <div class="grid grid-cols-1 gap-4 items-start lg:grid-cols-3 lg:gap-8">
        <!-- Left column -->
        <div class="grid grid-cols-1 gap-4 lg:col-span-3">
          <!-- Summary panel -->
          <section aria-labelledby="profile-overview-title">
            <div class="rounded-lg bg-white overflow-hidden shadow-lg">
              <div class="bg-white p-6 pt-4 flex lg:justify-between lg:flex-row flex-wrap sm:flex-nowrap">
                <div class="sm:flex sm:items-center sm:justify-between w-full">
                  <div class="sm:flex">
                    <div class="flex-shrink-0">
                    </div>
                    <div class="mt-4 text-center sm:mt-0 sm:pt-1 sm:text-left">
                      <div class="flex flex-row items-center">
                        <!-- Contact avatar -->
                        <div class="flex-shrink-0 h-10 w-10">
                          <%= account_avatar @account, class: "rounded-full mr-4 h-12 w-12" %>
                        </div>
                        <p class="text-xl font-bold text-gray-900 sm:text-2xl pl-4">
                          <% if allowed_to?(:edit?, @account) %>
                            <%= link_to @account.name, edit_account_path(@account), class: "text-gray-900" %>
                          <% else %>
                            <%= @account.name %>
                          <% end %>
                        </p>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="flex w-full lg:justify-end md:justify-end justify-evenly">
                  <div class="mt-4 text-center sm:mt-0 sm:pt-1 sm:text-left">
                    <div class="flex flex-row items-center">
                      <div class="flex-1 h-3 w-3 bg-<%= @account.active_status_color %>-400 rounded-full">
                      </div>
                      <div class="px-1 py-2 text-base capitalize font-bold leading-normal text-<%= @account.active_status_color %>-500">
                        <%= @account.active ? 'Active' : 'Inactive' %>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <p class="text-sm font-medium text-gray-600 py-1 px-6">
                <span class="font-medium text-gray-900">
                    Default Team Manager:
                </span>
                <span class="text-sm font-medium text-gray-600 py-1">
                  <%= @account.account_default_manager&.name %>
                </span>
              </p>
              <% @account.account_users.managers.each do |manager| %>
                <p class="text-sm font-medium text-gray-600 py-1 px-6">
                  <span class="font-medium text-gray-900">
                      Team Manager:
                  </span>
                  <span class="text-sm font-medium text-gray-600 py-1">
                      <%= manager.user.name %>
                  </span>
                </p>
              <% end %>
              <p class="text-sm font-medium text-gray-600 py-1 px-6">
                <span class="font-medium text-gray-900">
                    Date Created:
                </span>
                <span class="text-sm font-medium text-gray-600 py-1">
                  04/15/2018
                </span>
              </p>
              <p class="text-sm font-medium text-gray-600 py-1 px-6">
                <span class="font-medium text-gray-900">
                    Available Installers:
                </span>
                <span class="text-sm font-medium text-gray-600 py-1">
                 HorizonPWR, Winema Electric
                </span>
              </p>
              <div class="border-t border-gray-200 bg-gray-50 grid grid-cols-1 divide-y divide-gray-200 sm:grid-cols-5 sm:divide-y-0 sm:divide-x">
                <!--4 Bottom sections on top card-->
                <div class="px-6 py-5 text-sm text-center flex flex-nowrap sm:flex-wrap md:flex-wrap justify-between">
                  <div class="w-full">
                    <span class="text-gray-900 font-medium">
                      LEADS:
                    </span>
                    <span class="text-gray-600">
                      13,066
                    </span>
                  </div>
                </div>
                <div class="px-6 py-5 text-sm text-center flex flex-nowrap sm:flex-wrap md:flex-wrap justify-between">
                  <div class="w-full">
                    <span class="text-gray-900 font-medium">
                      QS:
                    </span>
                    <span class="text-gray-600">
                      5,646
                    </span>
                  </div>
                </div>
                <div class="px-6 py-5 text-sm text-center flex flex-nowrap sm:flex-wrap md:flex-wrap justify-between">
                  <div class="w-full">
                    <span class="text-gray-900 font-medium">
                      ASSISTS:
                    </span>
                    <span class="text-gray-600">
                      2,421
                    </span>
                  </div>
                </div>
                <div class="px-6 py-5 text-sm text-center flex flex-nowrap sm:flex-wrap md:flex-wrap justify-between">
                  <div class="w-full">
                    <span class="text-gray-900 font-medium">
                      CLOSES:
                    </span>
                    <span class="text-gray-600">
                      5,421
                    </span>
                  </div>
                </div>
                <div class="px-6 py-5 text-sm text-center flex flex-nowrap sm:flex-wrap md:flex-wrap justify-between">
                  <div class="w-full">
                    <span class="text-gray-900 font-medium">
                      INSTALLS:
                    </span>
                    <span class="text-gray-600">
                      2,421
                    </span>
                  </div>
                </div>
              </div>
            </div>
          </section>
        </div>

        <div class="grid grid-cols-1 gap-8 lg:col-span-2">
          <!-- Members panel -->
          <section>
            <div class="rounded-lg overflow-hidden shadow-lg bg-white">
              <div class="rounded-tl-lg rounded-tr-lg sm:rounded-tr-none relative group bg-white p-6 focus-within:ring-2 focus-within:ring-inset focus-within:ring-cyan-500">
                <p class="text-xl font-bold text-gray-900 sm:text-2xl">Members</p>
                <br/>
                <table class="w-full">
                  <thead>
                  <tr>
                    <th class="p-3 text-xs text-left text-gray-600 uppercase"><%= AccountUser.human_attribute_name(:user) %></th>
                    <th class="p-3 text-xs text-left text-gray-600 uppercase"><%= AccountUser.human_attribute_name(:roles) %></th>
                    <th class="p-3 text-xs text-left text-gray-600 uppercase">Start Date</th>
                    <th class="p-3 text-xs text-left text-gray-600 uppercase">Default Consultant</th>
                  </tr>
                  </thead>
                  <tbody>
                  <% @account.account_users.with_active_user.order(created_at: :asc).each do |account_user| %>
                    <% user = account_user.user %>
                    <tr class="border-t border-gray-400 group hover:bg-gray-200">
                      <td class="p-3">
                        <div class="flex items-center">
                          <div class="flex-shrink-0 h-10 w-10">
                            <%= image_tag avatar_url_for(user), class: "h-10 inline-block rounded-full mr-2" %>
                          </div>
                          <div class="ml-4">
                            <div class="flex w-full justify-evenly space-x-3 items-center">
                            <div class="text-m text-gray-900 w-full">
                              <%= user.name %>
                            </div>
                              <div class="mt-4 text-center sm:mt-0 sm:pt-1 sm:text-left">
                            <div class="flex flex-row items-center space-x-1">
                              <div class="flex-1 h-2 w-2 bg-<%= user.active_status_color %>-400 rounded-full">
                              </div>
                              <div class="text-sm capitalize font-bold leading-normal text-<%= user.active_status_color %>-500">
                                <%= user.active ? 'Active' : 'Inactive' %>
                              </div>
                            </div>
                              </div>
                            </div>
                            <div class="text-sm text-gray-500">
                              <%= user.job_position&.name %>
                            </div>
                          </div>
                        </div>
                      </td>
                      <td class="p-3 w-1/5">
                          <%= account_user_roles(@account, account_user).join(", ") %>
                      </td>
                      <td class="p-3 text-left">
                        <%= link_to user_path(user), class: "text-gray-600" do %>
                          <%= date_mdy(user.created_at) || 'N/A' %>
                        <% end %>
                      </td>
                      <td class="p-3 text-left">


                        <div class="flex items-center">
                          <div class="flex-shrink-0 h-10 w-10">
                            <%= image_tag avatar_url_for(user), class: "h-10 inline-block rounded-full mr-2" %>
                          </div>
                          <div class="ml-4">
                            <div class="flex w-full flex-row justify-evenly space-x-3">
                              <div class="text-m text-gray-900 w-full">
                                <%= account_user.default_energy_consultant.name %>
                                <div class="text-sm text-gray-500">
                                  <%= account_user.default_energy_consultant.job_position&.name %>
                                </div>
                              </div>
                              <div class="sm:text-left">
                                <div class="flex flex-row space-x-1">
                                  <% if allowed_to?(:edit?, account_user) %>
                                      <%= link_to edit_account_account_user_path(@account, account_user), class:"text-gray-400" do %>
                                        <svg aria-hidden="true" data-prefix="far" data-icon="edit" class="fa-edit h-4 w-4 inline-block" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 576 512">
                                          <path fill="currentColor" d="M402.3 344.9l32-32c5-5 13.7-1.5 13.7 5.7V464c0 26.5-21.5 48-48 48H48c-26.5 0-48-21.5-48-48V112c0-26.5 21.5-48 48-48h273.5c7.1 0 10.7 8.6 5.7 13.7l-32 32c-1.5 1.5-3.5 2.3-5.7 2.3H48v352h352V350.5c0-2.1.8-4.1 2.3-5.6zm156.6-201.8L296.3 405.7l-90.4 10c-26.2 2.9-48.5-19.2-45.6-45.6l10-90.4L432.9 17.1c22.9-22.9 59.9-22.9 82.7 0l43.2 43.2c22.9 22.9 22.9 60 .1 82.8zM460.1 174L402 115.9 216.2 301.8l-7.3 65.3 65.3-7.3L460.1 174zm64.8-79.7l-43.2-43.2c-4.1-4.1-10.8-4.1-14.8 0L436 82l58.1 58.1 30.9-30.9c4-4.2 4-10.8-.1-14.9z"/>
                                        </svg>
                                    <% end %>
                                  <% end %>
                              </div>
                            </div>
                          </div>

                        </div>

                        </div>
                      </td>
                    </tr>
                  <% end %>

                  <%# Invitations %>
                  <% @account.account_invitations.each do |account_invitation| %>
                    <tr class="border-t border-gray-400 group hover:bg-gray-200">
                      <td class="p-3">
                        <%= image_tag avatar_url_for(account_invitation), class: "h-4 h-6 inline-block rounded-full mr-2" %>
                        <%= account_invitation.name %>
                        <div class="inline-block px-4 py-1 ml-2 text-xs font-bold leading-normal text-gray-700 uppercase bg-gray-400 rounded-full">Awaiting
                          response
                        </div>
                        <%= tag.button t(".copy_link"), class: "btn btn-link", data: { controller: "clipboard", clipboard_text: account_invitation_url(account_invitation) } if account_admin?(@account, current_user) %>
                      </td>
                      <td class="p-3"><%= account_user_roles(@account, account_invitation).join(", ") %></td>
                      <td class="w-32 p-3 text-center">
                        <%= link_to t(".edit"), edit_account_account_invitation_path(@account, account_invitation), class: "text-sm text-blue-600 no-underline" if account_admin?(@account, current_user) %>
                      </td>
                    </tr>
                  <% end %>
                  </tbody>
                </table>
              </div>
            </div>
          </section>
          <section>
            <div class="rounded-lg overflow-hidden shadow-lg bg-white">
              <div class="rounded-tl-lg rounded-tr-lg sm:rounded-tr-none relative group bg-white p-6 focus-within:ring-2 focus-within:ring-inset focus-within:ring-cyan-500">
                <p class="text-xl font-bold text-gray-900 sm:text-2xl">Team Stats?</p>
              </div>
            </div>
          </section>
        </div>
        <!-- Right column -->
        <div class="grid grid-span-3 gap-4">
          <!-- Needs to be updated-->
          <form action="/" accept-charset="UTF-8" method="get">
            <div class="border border-gray-300 rounded-lg relative mb-2">
              <input class="transition focus:outline-0 border border-transparent focus:bg-white focus:border-gray-300 placeholder-gray-700 rounded-lg bg-gray-300 py-2 pr-4 pl-10 block w-full appearance-none leading-normal ds-input shadow-inner shadow-lg" placeholder="Search..." type="text" name="q" id="q" value="<%= params[:q] %>">
              <div class="pointer-events-none absolute inset-y-0 left-0 pl-4 flex items-center">
                <svg class="fill-current pointer-events-none text-gray-600 w-4 h-4" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20">
                  <path d="M12.9 14.32a8 8 0 1 1 1.41-1.41l5.35 5.33-1.42 1.42-5.33-5.34zM8 14A6 6 0 1 0 8 2a6 6 0 0 0 0 12z"></path>
                </svg>
              </div>
            </div>
          </form>
          <div class="bg-white border border-gray-300 rounded-lg shadow-lg">
            <%= link_to "Field Marketers", users_path(scope: 'inactive'), class: "block no-underline p-3 px-6 text-gray-700 hover:bg-gray-100" %>
            <%= link_to "Energy Consultants", users_path(scope: 'inactive'), class: "block no-underline p-3 px-6 text-gray-700 hover:bg-gray-100" %>
          </div>
          <div class="flex-shrink-0 mt-3 text-center sm:mt-0 sm:text-right hidden">
            <%#= switch_account_button @account, label: t(".switch"), class: "btn btn-primary outline no-underline", form_class: "inline-block" unless current_account == @account %>
            <%= link_to t(".invite"), new_account_account_invitation_path(@account), class: "btn btn-primary outline no-underline" if !@account.personal? && account_admin?(@account, current_user) %>
            <%= link_to t(".edit_account"), edit_account_path(@account), class: "btn btn-primary outline" if account_admin?(@account, current_user) %>
          </div>
        </div>
      </div>
    </div>

  </main>
</div>